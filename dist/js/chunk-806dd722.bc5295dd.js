(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-806dd722"],{"365c":function(t,e,a){"use strict";a.d(e,"f",(function(){return s})),a.d(e,"e",(function(){return l})),a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return c})),a.d(e,"g",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return u}));var i=a("b775"),s=function(t,e){return Object(i["a"])({method:"POST",url:"/api/user/login",data:{username:t,password:e}})},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.keyword,a=void 0===e?"":e,s=t.recommend,l=void 0===s?"":s,n=t.classify,c=void 0===n?"全部":n,o=t.page_size,r=void 0===o?10:o,u=t.currentPage,d=void 0===u?1:u;return Object(i["a"])({method:"GET",url:"/api/blog/list",params:{keyword:a,recommend:l,classify:c,page_size:r,currentPage:d}})},n=function(t){return Object(i["a"])({method:"GET",url:"/api/blog/detail",params:{id:t}})},c=function(t){var e=t.title,a=t.content,s=t.recommend,l=t.classify,n=t.recImg,c=t.subtitle;return Object(i["a"])({method:"POST",url:"/api/blog/new",data:{title:e,content:a,recommend:s,classify:l,recImg:n,subtitle:c}})},o=function(t,e){var a=e.title,s=e.content,l=e.recommend,n=e.classify,c=e.recImg,o=e.subtitle;return Object(i["a"])({method:"POST",url:"/api/blog/update?id="+t,data:{title:a,content:s,recommend:l,classify:n,recImg:c,subtitle:o}})},r=function(t){return Object(i["a"])({method:"POST",url:"/api/blog/del?id="+t})},u=function(){return Object(i["a"])({method:"GET",url:"/api/blog/artClassify"})}},a5f9:function(t,e,a){"use strict";var i=a("fc11"),s=a.n(i);s.a},d668:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("span",{staticClass:"back",on:{click:t.goBack}},[a("svg-icon",{attrs:{iconClass:"fanhui"}}),t._v("返回 ")],1),a("div",{staticClass:"blog-edit-add"},[a("h4",{staticClass:"title"},[t._v(t._s(t.blogType))]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("博客标题：")]),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("博客类型：")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择Blog类型"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.classifyList,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("是否推荐：")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},model:{value:t.switch_value,callback:function(e){t.switch_value=e},expression:"switch_value"}})],1),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("推荐图片：")]),a("el-upload",{staticClass:"upload-demo",attrs:{action:"http://120.78.165.228/api/file/uploadFile/multiple","on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-success":t.uploadSuccess,"file-list":t.fileList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("文章说明：")]),a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.subtitle,callback:function(e){t.subtitle=e},expression:"subtitle"}})],1),a("mavon-editor",{ref:"md",on:{imgAdd:t.handleEditorImgAdd,save:t.handleOnSave},model:{value:t.markdownValue,callback:function(e){t.markdownValue=e},expression:"markdownValue"}}),a("el-button",{staticClass:"save",attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleOnSave(e)}}},[t._v("保存")])],1)])},s=[],l=(a("7ae7"),a("a677"),a("4045"),a("c1f4"),a("c354"),a("b3f9"),a("3547"),a("d780"),a("365c")),n=a("82ae"),c=a.n(n),o={data:function(){return{title:"",markdownValue:"",subtitle:"",classifyList:[],value:"",switch_value:"",fileList:[],recImg:""}},created:function(){this.getArtClassifyList(),this.initData()},computed:{blogType:function(){var t=this.$route.query.type;return"add"===t?"新增博客":"edit"===t?"更新博客":void 0}},methods:{goBack:function(){this.$router.go(-1)},initData:function(){var t=this;if("更新博客"===this.blogType){var e=this.$route.query.id;Object(l["d"])(e).then((function(e){t.markdownValue=e.data.content,t.value=e.data.classify,t.switch_value=e.data.recommend,t.title=e.data.title,t.fileList=[{name:"",url:e.data.recImg}],t.subtitle=e.data.subtitle}))}},handleOnSave:function(){var t=this;if(this.title)if(this.value)if(this.subtitle){if("新增博客"===this.blogType)Object(l["b"])({title:this.title,content:this.markdownValue,recommend:this.switch_value,classify:this.value,recImg:this.recImg,subtitle:this.subtitle}).then((function(e){t.$message.success("新建成功")}));else if("更新博客"===this.blogType){var e=this.$route.query.id;Object(l["g"])(e,{title:this.title,content:this.markdownValue,recommend:this.switch_value,classify:this.value,recImg:this.recImg,subtitle:this.subtitle}).then((function(e){t.$message.success("更新成功")}))}}else this.$message.error("文章说明不能为空");else this.$message.error("请选择文章类型");else this.$message.error("标题不能为空")},handleEditorImgAdd:function(t,e){var a=this,i=new FormData;i.append("file",e);var s=c.a.create({headers:{"Content-Type":"multipart/form-data"}});s.post("http://120.78.165.228/api/file/uploadFile/multiple",i).then((function(i){if(0===i.data.errno){a.$message.success("上传成功");var s=i.data.data.file[0],l=e.name;l.includes("-")&&(l=l.replace(/-/g,""));var n=a.markdownValue;if(n.includes(l)){var c="(".concat(t,")"),o="(http://120.78.165.228/api/".concat(s.destination).concat(s.filename,")"),r=n.indexOf(c);console.log("index",r);var u=n.replace(c,""),d=function(t,e,a){return t.slice(0,e)+a+t.slice(e)};console.log("old",a.markdownValue),a.markdownValue=d(u,r,o),console.log("new",a.markdownValue)}}else a.$message.error(i.data.message)}))},handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t)},uploadSuccess:function(t,e,a){var i=t.data.file[0];this.recImg="http://120.78.165.228/api/".concat(i.destination).concat(i.filename)},getArtClassifyList:function(){var t=this;Object(l["a"])().then((function(e){t.classifyList=e.data}))}}},r=o,u=(a("a5f9"),a("5511")),d=Object(u["a"])(r,i,s,!1,null,"6d1f4208",null);e["default"]=d.exports},fc11:function(t,e,a){}}]);
//# sourceMappingURL=chunk-806dd722.bc5295dd.js.map